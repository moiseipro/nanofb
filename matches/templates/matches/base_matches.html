{% extends '../base/app_main.html' %}
{% load i18n %}
{% load static %}

{% block title %}{% trans 'Matches' %}{% endblock %}

{% block custom_style %}
    <link rel="stylesheet" href="{% static 'matches/css/style.css' %}">
{% endblock %}

{% block content %}

    {% if messages %}
        {% for message in messages %}
            <div class="alert {% if message.tags %} {{ message.tags }} {% endif %} alert-warning alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
        {% endfor %}
    {% endif %}

    <div class="row">
        <div class="col-sm-12">
            <div class="card mb-0">
                <div class="card-header py-2">
                    <form action="#">
                        <div class="row">
                            <div class="col-2">
                                <button class="btn btn-block btn-sm btn-outline-success" type="button" id="addMatchBtn">
                                    Добавить
                                </button>
                            </div>
                            <div class="col-2">
                                <button class="btn btn-block btn-sm btn-outline-primary" type="button" aria-expanded="false" aria-controls="collapseExample">
                                    Планирование
                                </button>
                            </div>
                            <div class="col-2">
                                <button class="btn btn-block btn-sm btn-outline-primary" type="button" data-toggle="collapse" data-target="#collapse-protocol" aria-expanded="false" aria-controls="collapseExample">
                                    Список
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="card-body scrollable-block">
                    <div class="row">
                        <div class="col">
                            <div class="table-responsive">
                                <table id="matches" class="table table-sm table-striped table-bordered dataTable" style="width:100%">
                                    <colgroup>
                                        <col span="1" style="width: 10%;">
                                        <col span="1" style="width: 5%;">
                                        <col span="1" style="width: 5%;">
                                        <col span="1" style="width: 5%;">
                                        <col span="1" style="width: 25%;">
                                        <col span="1" style="width: 10%;">
                                        <col span="1" style="width: 25%;">
                                        <col span="1" style="width: 7%;">
                                        <col span="1" style="width: 8%;">
                                    </colgroup>
                                    <thead>
                                        <tr>
                                            <th class="text-center">Дата</th>
                                            <th class="text-center">Д.Н.</th>
                                            <th class="text-center" title="Время"><i class="fa fa-clock-o" aria-hidden="true"></i></th>
                                            <th class="text-center" title="Результат (В.П.Н.)"><i class="fa fa-trophy" aria-hidden="true"></i></th>
                                            <th>Команда</th>
                                            <th class="text-center">Счет</th>
                                            <th>Команда</th>
                                            <th class="text-center" title="Длительность"><i class="fa fa-clock-o" aria-hidden="true"></i></th>
                                            <th class="text-center"><i class="fa fa-cog" aria-hidden="true"></i></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for match in matches %}
                                        <tr class="match-row" data-id="{{ match.event_id }}">
                                            <td class="text-center">{{ match.date }}</td>
                                            <td class="text-center">{{ match.date_day }}</td>
                                            <td class="text-center">{{ match.date_time }}</td>
                                            <td class="text-center">
                                                {% if match.result == 1 %}
                                                    <span class="text-success" title="Выигрыш">В</span>
                                                {% elif match.result == 2 %}
                                                    <span class="text-danger" title="Проигрыш">П</span>
                                                {% else %}
                                                    <span class="text-secondary" title="Ничья">Н</span>
                                                {% endif %}
                                            </td>
                                            <td>{{ match.team_name }}</td>
                                            <td class="text-center">
                                                {{ match.goals }}:{{ match.o_goals }}
                                                {% if match.goals_equal == 1 %}
                                                    ({{ match.penalty }}:{{ match.o_penalty }})
                                                {% endif %}
                                            </td>
                                            <td>{{ match.opponent }}</td>
                                            <td class="text-center">{{ match.duration }}</td>
                                            <td class="text-center">
                                                <a class="btn btn-sm btn-outline-secondary" href="match?id={{ match.event_id }}" action="goToMatchCard">
                                                    <i class="fa fa-search" aria-hidden="true"></i>
                                                </a>
                                                <a class="btn btn-sm btn-outline-secondary" href="#" action="editMatch">
                                                    <i class="fa fa-pencil" aria-hidden="true"></i>
                                                </a>
                                                <a class="btn btn-sm btn-outline-secondary" href="#" action="removeMatch">
                                                    <i class="fa fa-trash" aria-hidden="true"></i>
                                                </a>
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="col collapse" id="collapse-protocol">
                            <div class="table-responsive">
                                <table id="protocol" class="table table-sm table-striped table-bordered dataTable" style="width:100%">
                                    <thead>
                                        <tr>
                                            <th>№</th>
                                            <th></th>
                                            <th></th>
                                            <th>с</th>
                                            <th>по</th>
                                            <th>гол.</th>
                                            <th>пен.</th>
                                            <th>пас.</th>
                                            <th>ж.к.</th>
                                            <th>к.к.</th>
                                            <th>оц.</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                        <div id="block-video-info" class="col-md-12 col-lg-3 d-none">

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="matchEditModal" tabindex="-1" role="dialog" aria-labelledby="matchEditModalLbl" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <span class="add-title">Добавление матча:</span>
                        <span class="edit-title d-none">Изменение матча:</span>
                    </h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                <div class="modal-body" data-id="">
                    <div class="row">
                        <div class="col-6 bg-light pt-1">Дата</div>
                        <div class="col-6 mb-0">
                            <div class="row">
                                <div class="col-6 mb-0 pl-0 pr-0">
                                    <input class="form-control form-control-sm" name="date" type="date" value="" autocomplete="off" required="">
                                </div>
                                <div class="col-6 mb-0 pl-0">
                                    <input class="form-control form-control-sm" name="time" type="time" value="" autocomplete="off" required="">
                                </div>
                            </div>
                        </div>
                        <div class="col-6 bg-light pt-1">Длительность (Ч:М:С)</div>
                        <div class="col-6 mb-0 pl-0">
                            <input class="form-control form-control-sm" name="duration" type="time" step="2" value="" autocomplete="off" required="">
                        </div>
                        <div class="col-6 bg-light pt-1">Турнир</div>
                        <div class="col-6 mb-0 pl-0">
                            <input class="form-control form-control-sm" name="tournament" type="text" placeholder="Турнир" value="" autocomplete="off">
                        </div>
                        <div class="col-6 bg-light pt-1">Место</div>
                        <div class="col-6 mb-0 pl-0">
                            <input class="form-control form-control-sm" name="place" type="text" placeholder="Место" value="" autocomplete="off">
                        </div>
                        <div class="col-6 bg-light pt-1">Тип матча</div>
                        <div class="col-6 mb-0 pl-0">
                            <select class="form-control form-control-sm" name="m_type">
                                <option value="0">Неофициальный</option>   
                                <option value="1">Официальный</option>   
                            </select>
                        </div>
                        <div class="col-6 bg-light pt-1">Формат матча</div>
                        <div class="col-6 mb-0 pl-0">
                            <input class="form-control form-control-sm" name="m_format" type="text" placeholder="Формат" value="" autocomplete="off">
                        </div>
                        <div class="col-6 bg-light pt-1">Команда 1</div>
                        <div class="form-group col-6 mb-0 pl-0">
                            <input class="form-control form-control-sm" name="team_name" type="text" value="" readonly="">
                        </div>
                        <div class="col-6 bg-light pt-1">Команда 2</div>
                        <div class="form-group col-6 mb-0">
                            <div class="row">
                                <div class="col-8 mb-0 pl-0 pr-0">
                                    <input class="form-control form-control-sm" name="opponent_name" type="text" value="" autocomplete="off" required="">
                                </div>
                                <div class="col-4 mb-0 pl-0">
                                    <select class="form-control form-control-sm" name="opponent_team">
                                        <option value="">---</option>
                                        {% for team in teams_list %}
                                            <option value="{{ team.id }}">{{ team.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 bg-light pt-1">Счет</div>
                        <div class="col-6 mb-0 pl-0">
                            <div class="row mb-0">
                                <div class="col-6 pr-0">
                                    <div class="row">
                                        <div class="col-5 pr-0">
                                            <input class="form-control form-control-sm float-left" name="goals" type="number" value="0">
                                        </div>
                                        <div class="col-2 px-0 text-center">
                                            <span class="float-left pt-1 px-3">:</span>
                                        </div>
                                        <div class="col-5 pl-0">
                                            <input class="form-control form-control-sm float-left" name="o_goals" type="number" value="0">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6 pr-0">
                                    <div class="row">
                                        <div class="col-1 px-0">
                                            <span class="float-right pt-1 pr-0 pl-1">(</span>
                                        </div>
                                        <div class="col-4 px-0">
                                            <input class="form-control form-control-sm float-left" name="penalty" type="number" value="0">
                                        </div>
                                        <div class="col-1 px-0">
                                            <span class="float-left pt-1 px-1">:</span>
                                        </div>
                                        <div class="col-4 px-0">
                                            <input class="form-control form-control-sm float-left" name="o_penalty" type="number" value="0">
                                        </div>
                                        <div class="col-1 pl-0">
                                            <span class="float-left pt-1 px-0">)</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" name="save">Добавить</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Назад</button>
                </div>
            </div>
        </div>
    </div>

{% endblock %}
{% block custom_scripts %}
    <script src="{% static 'matches/js/base_matches.js' %}"></script>
{% endblock %}
